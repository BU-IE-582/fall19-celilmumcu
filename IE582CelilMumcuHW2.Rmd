---
title: "celilmumcuhw2"
output: html_document
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)



```


```{r cars}
library(data.table)
Musk1 = read.csv("/Users/ASUS/Documents/Musk1.csv", header = FALSE)
Musk1withoutFirstSecondCol=matrix(0,476,166)
Musk1withoutFirstSecondCol=Musk1[,3:168]
pcaMusk1= princomp(Musk1)
summary(pcaMusk1,loadings = T)
```

##First component covers 40% of total variance, second one covers 12% of it, third one covers 6%, so on.
## what is hidden in the first component

```{r pressure, echo=FALSE}
barplot(pcaMusk1$scores[,1])
```

```{r }
str(pcaMusk1)
```

```{r , echo=FALSE}
plot(pcaMusk1)
plot(pcaMusk1$scores[,1],pcaMusk1$scores[,2],main= "pcaMusk1scores",col=Musk1[,2]+1,pch=".",cex=7)
```

```{r , echo=FALSE}
library(mlbench)
require(mlbench)
spiralMusk1= mlbench.spirals(100,1,0.1)
plot(spiralMusk1, main= "spiralMusk1")
pcaspiralMusk1= princomp(spiralMusk1$x)
plot(pcaspiralMusk1)
```

##TASK2

```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

## will need libraries above

```{r }
library(jpeg)
library(raster)
imageofalikoc = readJPEG("/Users/ASUS/Documents/alikoc256x256.jpg")
```

## have chosen the photo of Ali Koc and arranged sizes to 256x256 by using Paint

```{r }
dim(imageofalikoc)
```

## there are 3 dimensions

```{r , echo=FALSE}
par(mfrow= c(1,1))
plot(0:256, 0:256, type="n")
rasterImage(imageofalikoc, 0, 0, 256, 256,interpolate=FALSE)
```

## to create an empty graph or plot

```{r , echo=FALSE}
par(mfrow= c(1,1))
redimageofalikoc= imageofalikoc
redimageofalikoc[,,2:3]= 0
plot(1:256, 1:256, type='n')
rasterImage(redimageofalikoc,0,0,256,256, interpolate = FALSE)
```

```{r , echo=FALSE}
greenimageofalikoc= imageofalikoc
greenimageofalikoc[,,3]= 0
greenimageofalikoc[,,1]= 0
plot(1:256, 1:256, type='n')
rasterImage(greenimageofalikoc,0,0,256,256, interpolate = FALSE)
```

```{r , echo=FALSE}
blueimageofalikoc= imageofalikoc
blueimageofalikoc[,,1:2]= 0
plot(1:256, 1:256, type='n')
rasterImage(blueimageofalikoc,0,0,256,256, interpolate = FALSE)
```

##to examine channels with their own

```{r , echo=FALSE}
plot(1:256, 1:256, type='n')
rednoisealikoc= matrix(runif(256*256,min(imageofalikoc),max(imageofalikoc)*(0.1)),256,256)
greennoisealikoc= matrix(runif(256*256,min(imageofalikoc),max(imageofalikoc)*(0.1)),256,256)
bluenoisealikoc= matrix(runif(256*256,min(imageofalikoc),max(imageofalikoc)*(0.1)),256,256)
redcolor= imageofalikoc[,,1]
greencolor= imageofalikoc[,,2]
bluecolor= imageofalikoc[,,3]
noisyred= redcolor+ rednoisealikoc
redcolor= imageofalikoc[1:256,1:256,1]
noisyred= redcolor+ rednoisealikoc
noisygreen= greencolor+ greennoisealikoc
noisyblue= bluecolor+ bluenoisealikoc
noisyimageofalikoc=imageofalikoc
noisyimageofalikoc[,,1]=noisyred
noisyimageofalikoc[,,2]=noisygreen
noisyimageofalikoc[,,3]=noisyblue
noisyimageofalikoc= ifelse(noisyimageofalikoc>1,1,noisyimageofalikoc)
rasterImage(noisyimageofalikoc,0,0,256,256,interpolate = FALSE)
```

## to create noisy image of ali koc,generated by using runif and paying attention to given criteria

```{r , echo=FALSE}
par(mfrow= c(1,3))
image(1:256,1:256,t(apply(redcolor, 2, rev)))
image(1:256,1:256,t(apply(greencolor, 2, rev)))
image(1:256,1:256,t(apply(bluecolor, 2, rev)))
```

## to display channels separately

```{r , echo=FALSE}
rednoisepart= noisyimageofalikoc
rednoisepart[,,2:3]= 0
plot(1:256, 1:256, type='n')
rasterImage(rednoisepart,0,0,256,256,interpolate = FALSE)
```

```{r , echo=FALSE}
greennoisepart= noisyimageofalikoc
greennoisepart[,,1]= 0
greennoisepart[,,3]= 0
plot(1:256, 1:256, type='n')
rasterImage(greennoisepart,0,0,256,256,interpolate = FALSE)
```

```{r , echo=FALSE}
bluenoisepart= noisyimageofalikoc
bluenoisepart[,,1:2]= 0
plot(1:256, 1:256, type='n')
rasterImage(bluenoisepart,0,0,256,256,interpolate = FALSE)
```

```{r , echo=FALSE}
par(mfrow=c(1,1))
plot(0:1,0:1,type='n', main= "Color Values' Distributions of Pixels", xlab= '',ylab= '')
points(redcolor, pch=16,cex=0.75, col="red")
points(greencolor, pch=16,cex=0.75, col="green")
points(bluecolor, pch=16,cex=0.75, col="blue")
```

## to transform noisy image of ali koc to greyscale image of ali koc

```{r , echo=FALSE}
noisyimageofalikoc_greyscale= noisyimageofalikoc[,,1]+ noisyimageofalikoc[,,2]+ noisyimageofalikoc[,,3]
noisyimageofalikoc_greyscale= noisyimageofalikoc_greyscale/ max(noisyimageofalikoc_greyscale)
plot(c(0,1), c(0,1), t='n', xlab='', ylab='')
rasterImage(noisyimageofalikoc_greyscale,0,0,1,1)
```

```{r }
str(noisyimageofalikoc_greyscale)
```
## matrix inputs are (0,(256-24)^2, 25^2)
##row number of the data matrix
## 25x25patches for each pixel 

```{r , echo=FALSE}
n=1 
patches_matrix=matrix(0,53824,625) 
for(i in 13:244){
  for(j in 13:244){
    patch1=noisyimageofalikoc_greyscale[i-12,(j-12):(j+12)]
    patch2=noisyimageofalikoc_greyscale[i-11,(j-12):(j+12)]
    patch3=noisyimageofalikoc_greyscale[i-10,(j-12):(j+12)]
    patch4=noisyimageofalikoc_greyscale[i-9,(j-12):(j+12)]
    patch5=noisyimageofalikoc_greyscale[i-8,(j-12):(j+12)]
    patch6=noisyimageofalikoc_greyscale[i-7,(j-12):(j+12)]
    patch7=noisyimageofalikoc_greyscale[i-6,(j-12):(j+12)]
    patch8=noisyimageofalikoc_greyscale[i-5,(j-12):(j+12)]
    patch9=noisyimageofalikoc_greyscale[i-4,(j-12):(j+12)]
    patch10=noisyimageofalikoc_greyscale[i-3,(j-12):(j+12)]
    patch11=noisyimageofalikoc_greyscale[i-2,(j-12):(j+12)]
    patch12=noisyimageofalikoc_greyscale[i-1,(j-12):(j+12)]
    patch13=noisyimageofalikoc_greyscale[i,(j-12):(j+12)]
    patch14=noisyimageofalikoc_greyscale[i+1,(j-12):(j+12)]
    patch15=noisyimageofalikoc_greyscale[i+2,(j-12):(j+12)]
    patch16=noisyimageofalikoc_greyscale[i+3,(j-12):(j+12)]
    patch17=noisyimageofalikoc_greyscale[i+4,(j-12):(j+12)]
    patch18=noisyimageofalikoc_greyscale[i+5,(j-12):(j+12)]
    patch19=noisyimageofalikoc_greyscale[i+6,(j-12):(j+12)]
    patch20=noisyimageofalikoc_greyscale[i+7,(j-12):(j+12)]
    patch21=noisyimageofalikoc_greyscale[i+8,(j-12):(j+12)]
    patch22=noisyimageofalikoc_greyscale[i+9,(j-12):(j+12)]
    patch23=noisyimageofalikoc_greyscale[i+10,(j-12):(j+12)]
    patch24=noisyimageofalikoc_greyscale[i+11,(j-12):(j+12)]
    patch25=noisyimageofalikoc_greyscale[i+12,(j-12):(j+12)]
    
    patches_matrix[n, ]=c(patch1,patch2,patch3,patch4,patch5,patch6,patch7,patch8,patch9,patch10,patch11,patch12,patch13,patch14,patch15,patch16,patch17,patch18,patch19,patch20,patch21,patch22,patch23,patch24,patch25)
    
    n=n+1}}
pcagreyscale= princomp(patches_matrix)
plot(pcagreyscale)
```

```{r }
str(pcagreyscale)
```

```{r }
summary(pcagreyscale)
```

##plotta da görüldüðü gibi variance ýn çoðu comp 1'den kaynaklanýyor. dimension'ý 1e düþürsek bile varianceýn çoðunu cover ediyoruz. Proportion of variance sonuçlarda çýkmadý, belki de component sayýsý çok olduðu için. Fakat çok da ihtiyacýmýz yok. Comp1 çok bariz variance ýn çoðundan sorumlu.
##to reconstruct the image to use first, second and third components

```{r , echo=FALSE}
firstcomponent=matrix(0,232,232)
t=1
for (k in 1:232) {
  firstcomponent[k,]=pcagreyscale$scores[t:(232*k),1]
  t=232*k+1
}

secondcomponent=matrix(0,232,232)
t=1
for (k in 1:232) {
  secondcomponent[k,]=pcagreyscale$scores[t:(232*k),2]
  t=232*k+1
}

thirdcomponent=matrix(0,232,232)
t=1
for (k in 1:232) {
  thirdcomponent[k,]=pcagreyscale$scores[t:(232*k),3]
  t=232*k+1
}
plot(c(0,1),c(0,1),t='n')
rasterImage((firstcomponent-min(firstcomponent))/(max(firstcomponent)-min(firstcomponent)),0,0,1,1)

```

```{r , echo=FALSE}
plot(c(0,1),c(0,1),t='n')
rasterImage((secondcomponent-min(secondcomponent))/(max(secondcomponent)-min(secondcomponent)),0,0,1,1)
```

```{r , echo=FALSE}
plot(c(0,1),c(0,1),t='n')
rasterImage((thirdcomponent-min(thirdcomponent))/(max(thirdcomponent)-min(thirdcomponent)),0,0,1,1)

```

## i am gonna put the covariance, eigenvalues and eigenvectors into another matrix

```{r }
covariance_pcagreyscale=cov(patches_matrix)
eigenvalues_pcagreyscale=eigen(covariance_pcagreyscale)$values
eigenvectors_pcagreyscale=eigen(covariance_pcagreyscale)$vectors
eigenvalues_pcagreyscale
```

```{r }
eigenvectors_pcagreyscale[,1]
```

```{r }
eigenvectors_pcagreyscale[,2]
```

```{r }
eigenvectors_pcagreyscale[,3]
firstpatch_eigenvector= matrix(0,625,625)
secondpatch_eigenvector= matrix(0,625,625)
thirdpatch_eigenvector= matrix(0,625,625)
```





Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
